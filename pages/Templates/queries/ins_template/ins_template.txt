INSERT INTO templates (
  template_name,
  template_type,
  template_description,
  template_is_active,
  template_version,
  template_from_field,
  template_email_to_field,
  template_email_bcc_field,
  template_email_subject,
  template_email_body_html,
  template_signature_field,
  template_header_html,
  template_footer_html,
  template_pdf_body,
  template_vars
) VALUES (
  NULLIF({{ j_tpl_ins_form.formData.template_name }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_type }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_description }}, ''),
  COALESCE({{ j_tpl_ins_form.formData.template_is_active ? 1 : 0 }}, 1),
  COALESCE({{ Number(j_tpl_ins_form.formData.template_version) }}, 1),

  -- Email-only
  NULLIF({{ j_tpl_ins_form.formData.template_from_field || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_email_to_field || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_email_bcc_field || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_email_subject || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_email_body_html || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_signature_field || null }}, ''),

  -- PDF fixed parts
  NULLIF({{ j_tpl_ins_form.formData.template_header_html || null }}, ''),
  NULLIF({{ j_tpl_ins_form.formData.template_footer_html || null }}, ''),

  -- PDF body
  NULLIF({{ j_tpl_ins_form.formData.template_pdf_body || null }}, ''),

  -- Declared placeholders
  {{ TemplateVarsHelper.buildVarJson(j_tpl_ins_form.formData) }}
);
