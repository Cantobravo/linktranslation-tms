{
  "gitSyncId": "6840b6d2ece888096e42342a_c12ed3f5-488a-47be-a400-e8b87a4bcf33",
  "id": "Projects_get_proj_guard",
  "pluginId": "mysql-plugin",
  "pluginType": "DB",
  "unpublishedAction": {
    "actionConfiguration": {
      "body": "SELECT\n  x.po_count,\n  x.billed_po_count,\n  x.bill_link_count,\n  x.bill_ids,\n  y.invoice_link_count,\n  y.invoice_ids\nFROM\n(\n  SELECT\n    COUNT(*) AS po_count,\n    SUM(\n      CASE\n        WHEN COALESCE(rpo.is_billed,'') IN ('Yes','Paid')\n             OR COALESCE(rpo.resource_bill_id,0) <> 0\n        THEN 1 ELSE 0 END\n    ) AS billed_po_count,\n    SUM(\n      CASE\n        WHEN COALESCE(l.purchase_order_id,0) <> 0\n        THEN 1 ELSE 0 END\n    ) AS bill_link_count,\n    TRIM(BOTH '|' FROM CONCAT_WS('|',\n      GROUP_CONCAT(DISTINCT CASE WHEN COALESCE(rpo.resource_bill_id,0) <> 0 THEN rpo.resource_bill_id END ORDER BY rpo.resource_bill_id SEPARATOR ','),\n      GROUP_CONCAT(DISTINCT l.resource_bill_id ORDER BY l.resource_bill_id SEPARATOR ',')\n    )) AS bill_ids\n  FROM resource_purchase_orders rpo\n  LEFT JOIN resource_bill_po_link l\n    ON l.purchase_order_id = rpo.purchase_order_id\n  WHERE rpo.project_id = {{ this.params.project_id }}\n) x\nCROSS JOIN\n(\n  SELECT\n    COUNT(*) AS invoice_link_count,\n    GROUP_CONCAT(DISTINCT ipl.customer_invoice_id ORDER BY ipl.customer_invoice_id SEPARATOR ',') AS invoice_ids\n  FROM invoice_project_link ipl\n  WHERE ipl.project_id = {{ this.params.project_id }}\n) y;\n",
      "encodeParamsToggle": true,
      "paginationType": "NONE",
      "pluginSpecifiedTemplates": [
        {
          "value": true
        }
      ],
      "timeoutInMillisecond": 10000
    },
    "confirmBeforeExecute": false,
    "datasource": {
      "id": "linktranslation",
      "isAutoGenerated": false,
      "name": "linktranslation",
      "pluginId": "mysql-plugin"
    },
    "dynamicBindingPathList": [
      {
        "key": "body"
      }
    ],
    "name": "get_proj_guard",
    "pageId": "Projects",
    "runBehaviour": "AUTOMATIC",
    "userSetOnLoad": false
  }
}