SELECT
  m.work_team_member_id,
  r.resource_full_name,
  COALESCE(SUM(p.progress_daily), 0)  AS progress_daily_sum,
  COALESCE(SUM(p.progress_weekly), 0) AS progress_weekly_sum
FROM work_team_members m
JOIN resources r
  ON r.resource_id = m.resource_id
LEFT JOIN work_team_member_credentials c
  ON c.work_team_member_id = m.work_team_member_id
  AND COALESCE(c.is_active, 1) = 1
LEFT JOIN wtm_progress p
  ON p.username = c.username
WHERE m.work_team_id = {{ appsmith.store.wtRow?.work_team_id || tbl_work_teams.triggeredRow?.work_team_id }}
GROUP BY m.work_team_member_id, r.resource_full_name
ORDER BY r.resource_full_name;
