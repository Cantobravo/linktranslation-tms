SELECT
  template_id AS value,
  -- Show name + version + type so PMs see what they're choosing
  CONCAT(
    template_name,
    IFNULL(CONCAT(' v', template_version), ''),
    ' â€” ',
    COALESCE(template_type, '')
  ) AS label,
  template_email_subject,
  template_email_body_html,
  template_email_bcc_field,
  template_email_to_field,
  template_type
FROM templates
WHERE COALESCE(`template_is_active`, 1) = 1
  -- case-insensitive "contains 'email'"
  AND LOCATE('Projects', LOWER(TRIM(`template_type`))) > 0
ORDER BY COALESCE(updated_at, created_at) DESC, template_name;
