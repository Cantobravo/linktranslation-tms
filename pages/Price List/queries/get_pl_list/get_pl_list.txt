SELECT
  pl.price_list_id,
  pl.price_list_type,
  pl.price_list_name,
  cur.currency_acronym AS currency,
  c.customer_name,
  CONCAT_WS(' ', r.resource_first_name, r.resource_last_name) AS resource_full_name,
  CASE WHEN pl.price_list_type='RESOURCE' AND COALESCE(pl.resource_id,0)=0 THEN 'Yes' ELSE 'No' END AS is_benchmark,
  pl.is_active,
  pl.created_at,
  pl.updated_at
FROM price_lists pl
LEFT JOIN currencies cur ON cur.currency_id = pl.currency_id
LEFT JOIN customers c    ON c.customer_id   = pl.customer_id
LEFT JOIN resources r    ON r.resource_id   = pl.resource_id
ORDER BY
  CASE WHEN pl.price_list_type='RESOURCE' AND COALESCE(pl.resource_id,0)=0 THEN 0 ELSE 1 END,
  pl.price_list_name;
