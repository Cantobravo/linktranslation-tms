SELECT
  po.purchase_order_id,
  p.project_name,
  CAST(po.volume AS DECIMAL(10,2)) AS volume,
  CAST(po.rate   AS DECIMAL(10,2)) AS rate,
  CAST(po.total  AS DECIMAL(10,2)) AS total,
  po.due_date,
  r.resource_id,
  r.resource_full_name
FROM resource_purchase_orders po
JOIN resources r ON r.resource_id = po.resource_id
LEFT JOIN projects p ON p.project_id = po.project_id
WHERE po.is_billed = 'No'
ORDER BY r.resource_full_name, po.due_date DESC, po.purchase_order_id DESC;
