SELECT
  po.purchase_order_id,
  p.project_name,
  CAST(po.volume AS DECIMAL(10,2)) AS volume,
  CAST(po.rate   AS DECIMAL(10,2)) AS rate,
  CAST(po.total  AS DECIMAL(10,2)) AS total,
  po.due_date
FROM resource_bill_po_link l
JOIN resource_purchase_orders po
  ON po.purchase_order_id = l.purchase_order_id
LEFT JOIN projects p
  ON p.project_id = po.project_id
WHERE l.resource_bill_id = IFNULL({{ appsmith.store.billRow?.resource_bill_id }}, -1)
ORDER BY po.due_date DESC, po.purchase_order_id DESC;
